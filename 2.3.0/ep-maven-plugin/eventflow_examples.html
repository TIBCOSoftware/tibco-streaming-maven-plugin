<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 2.0.0 from src/site/markdown/eventflow_examples.md.vm at 2025-04-30
 | Rendered using Apache Maven Fluido Skin 2.1.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 2.0.0" />
    <title>EventFlow fragment examples â€“ Event Processing Maven Plugin</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-2.1.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-2.1.0.min.js"></script>
  </head>
  <body>
    <div class="container-fluid container-fluid-top">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h1>Event Processing Maven Plugin</h1></div></div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2025-04-30<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 2.3.0</li>
        <li class="pull-right"><a href="https://devzone.tibco.com/display/comp/TIBCO+Component+Exchange">Component Exchange</a></li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Overview</li>
    <li><a href="index.html">Introduction</a></li>
    <li><a href="usage.html"><span class="icon-chevron-down"></span>Usage</a>
     <ul class="nav nav-list">
      <li><a href="general_examples.html">General examples</a></li>
      <li><a href="java_examples.html">Java fragment examples</a></li>
      <li><a href="java_jar_examples.html">Java jar examples</a></li>
      <li class="active"><a>EventFlow fragment examples</a></li>
      <li><a href="sw_examples.html">Streaming Web flow fragment examples</a></li>
      <li><a href="liveview_examples.html">LiveView fragment examples</a></li>
      <li><a href="application_examples.html">Application examples</a></li>
      <li><a href="contint_examples.html">CI examples</a></li>
      <li><a href="cloud_examples.html">Cloud examples</a></li>
     </ul></li>
    <li><a href="goals.html"><span class="icon-chevron-right"></span>Goals</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://www.tibco.com/" class="builtBy"><img class="builtBy" src="images/Tibco.svg" /> Cloud Software Group, Inc.</a>
            </div>
          </div>
        </header>
        <main id="bodyColumn" class="span10">
<section><a id="EventFlow_fragment_examples"></a>
<h1>EventFlow fragment examples</h1>
<ul>
<li><a href="#Directory_structure">Directory structure</a></li>
<li><a href="#Basic_build.2C_sbunit_test_and_install">Basic build, sbunit test and install</a></li>
<li><a href="#Calling_out_to_java">Calling out to java</a></li>
<li><a href="#External_dependency">External dependency</a></li>
<li><a href="#Building_native_libraries">Building native libraries</a></li>
<li><a href="#Third_party_native_libraries">Third party native libraries</a></li>
<li><a href="#Multiple_sbapps">Multiple sbapps</a></li>
<li><a href="#Java_adapters">Java adapters</a></li>
<li><a href="#EventFlow_fragment_referencing_another_EventFlow_fragment">EventFlow fragment referencing another EventFlow fragment</a></li></ul>
<section><a id="Directory_structure"></a>
<h2>Directory structure</h2>
<p>The recommended EventFlow directory structure is :</p>

<pre class="prettyprint linenums"><code class="language-shell">ep-eventflow-fragment
|------  pom.xml
|------  src
|     |------  main
|     |     |------  eventflow        - sbapp, ssql and sbint files
|     |     |------  java             - java functions, operators (if any)
|     |     |------  configurations   - HOCON configuration files
|     |     |------  resources        - sbfs, sbref, upgrade plan and other resources
|     |
|     |------  test
|     |     |------  eventflow        - sbapp, ssql and sbint files for tests
|     |     |------  java             - java functions, operators for tests (if any) and sbunit test case sources
|     |     |------  configurations   - HOCON configuration files for test
|     |     |------  resources        - sbfs, sbref, upgrade plan and other test resources
|     |
|     |------  site                   - documentation
|
|------  target                       - built artifacts
</code></pre>
<p>Note that the default EventFlow source directory is set by the plugin to
src/main/eventflow, and the default EventFlow test source directory is set to
src/test/eventflow.</p>
<p>Test sources (EventFlow, java, etc) are not included in the EventFlow fragment archive.</p></section><section><a id="Basic_build.2C_sbunit_test_and_install"></a>
<h2>Basic build, sbunit test and install</h2>
<p>The following pom.xml will build, unit test, and install an EventFlow fragment to the local maven
repository.</p>

<pre class="prettyprint linenums"><code class="language-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;

    &lt;!-- vim: set tabstop=4 softtabstop=0 expandtab shiftwidth=4 smarttab : --&gt;

    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;com.tibco.ep&lt;/groupId&gt;
    &lt;artifactId&gt;effrag&lt;/artifactId&gt;
    &lt;packaging&gt;ep-eventflow-fragment&lt;/packaging&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;
    &lt;name&gt;hello world&lt;/name&gt;

    &lt;!-- common definitions for this version of StreamBase --&gt;
    &lt;parent&gt;
        &lt;groupId&gt;com.tibco.ep.sb.parent&lt;/groupId&gt;
        &lt;artifactId&gt;ep-eventflow-fragment&lt;/artifactId&gt;
        &lt;version&gt;11.0.0&lt;/version&gt;
    &lt;/parent&gt;

&lt;/project&gt;
</code></pre>
<p>When the maven install goal is called (mvn install), this pom.xml instructs
maven to perform the following steps :</p>
<ol style="list-style-type: decimal;">

<li>
<p>Uses <a href="https://tibcosoftware.github.io/tibco-streaming-maven-plugin/2.3.0/ep-maven-plugin/install-product-mojo.html" class="externalLink">install-product</a> to check if the
dependent product ( in this case com.tibco.ep.sb.rt:platform_osxx86_64 ) is
installed.  If its not, maven will download the archive and the plugin
will extract into $TIBCO_EP_HOME.</p></li>
<li>
<p>Uses <a href="https://tibcosoftware.github.io/tibco-streaming-maven-plugin/2.3.0/ep-maven-plugin/set-resources-mojo.html" class="externalLink">set-resources</a> to add
configuration and EventFlow directories to the Maven resources.</p></li>
<li>
<p>Uses the standard maven plugin <a href="https://maven.apache.org/plugins/maven-resources-plugin/resources-mojo.html" class="externalLink">maven-resources-plugin:resources</a> to
copy resources to the output directory.</p></li>
<li>
<p>Uses <a href="https://tibcosoftware.github.io/tibco-streaming-maven-plugin/2.3.0/ep-maven-plugin/unpack-nar-mojo.html" class="externalLink">unpack-nar</a> to unpack
Native ARchives to the output directory.</p></li>
<li>
<p>Uses <a href="https://tibcosoftware.github.io/tibco-streaming-maven-plugin/2.3.0/ep-maven-plugin/unpack-fragment-mojo.html" class="externalLink">unpack-fragment</a> to unpack
fragments to the output directory.</p></li>
<li>
<p>Uses the standard maven plugin <a href="https://maven.apache.org/plugins/maven-compiler-plugin/testCompile-mojo.html" class="externalLink">maven-compiler-plugin:testCompile</a>
to compile any java main sources to class files.</p></li>
<li>
<p>Uses <a href="https://tibcosoftware.github.io/tibco-streaming-maven-plugin/2.3.0/ep-maven-plugin/generate-eventflow-fragment-mojo.html" class="externalLink">generate-eventflow-fragment</a>
to generate java classes for EventFlow modules from the eventflowdirectories into the main output
directory.</p></li>
<li>
<p>Uses <a href="https://tibcosoftware.github.io/tibco-streaming-maven-plugin/2.3.0/ep-maven-plugin/compile-eventflow-fragment-mojo.html" class="externalLink">compile-eventflow-fragment</a>
to copy EventFlow resources to the main output directory.</p></li>
<li>
<p>Uses the standard maven plugin <a href="https://maven.apache.org/plugins/maven-compiler-plugin/compile-mojo.html" class="externalLink">maven-compiler-plugin:compile</a>
to compile any generated java classes.</p></li>
<li>
<p>Uses the standard maven plugin <a href="https://maven.apache.org/plugins/maven-resources-plugin/testResources-mojo.html" class="externalLink">maven-resources-plugin:testResources</a>
to copy test resources to the test output directory.</p></li>
<li>
<p>Uses the standard maven plugin <a href="https://maven.apache.org/plugins/maven-compiler-plugin/testCompile-mojo.html" class="externalLink">maven-compiler-plugin:testCompile</a>
to compile any test java classes.</p></li>
<li>
<p>Uses <a href="https://tibcosoftware.github.io/tibco-streaming-maven-plugin/2.3.0/ep-maven-plugin/generate-test-eventflow-fragment-mojo.html" class="externalLink">generate-test-eventflow-fragment</a>
to generate java classes for eventflows from the testEventflowdirectories into the test output
directory.</p></li>
<li>
<p>Uses the standard maven plugin <a href="https://maven.apache.org/plugins/maven-compiler-plugin/testCompile-mojo.html" class="externalLink">maven-compiler-plugin:testCompile</a>
to compile any generated test java classes.</p></li>
<li>
<p>Uses <a href="https://tibcosoftware.github.io/tibco-streaming-maven-plugin/2.3.0/ep-maven-plugin/check-testcases-mojo.html" class="externalLink">check-testcases</a>
to check for test cases.</p></li>
<li>
<p>Uses <a href="https://tibcosoftware.github.io/tibco-streaming-maven-plugin/2.3.0/ep-maven-plugin/start-nodes-mojo.html" class="externalLink">start-nodes</a> to start a test cluster.
Since this pom.xml has no configuration, a single node is started
A.${artifactId} (ie A.helloworld in this example) with a random but unused
discovery port.</p></li>
<li>
<p>Uses <a href="https://tibcosoftware.github.io/tibco-streaming-maven-plugin/2.3.0/ep-maven-plugin/test-eventflow-fragment-mojo.html" class="externalLink">test-eventflow-fragment</a> to launch
sbunit on the cluster and report the test results.  Should the test cases
fail then the node will be stopped.</p></li>
<li>
<p>Uses <a href="https://tibcosoftware.github.io/tibco-streaming-maven-plugin/2.3.0/ep-maven-plugin/stop-nodes-mojo.html" class="externalLink">stop-nodes</a> to stop and remove the test
nodes</p></li>
<li>
<p>Uses <a href="https://tibcosoftware.github.io/tibco-streaming-maven-plugin/2.3.0/ep-maven-plugin/package-eventflow-fragment-mojo.html" class="externalLink">package-eventflow-fragment</a> to create
a EventFlow fragment zip file in the build directory (by default, set to target)
and attaches it to the build.</p></li>
<li>
<p>Uses the standard maven plugins to generate sources and javadoc and attach them to the source
jar.</p></li>
<li>
<p>Uses the standard maven plugin <a href="https://maven.apache.org/plugins/maven-install-plugin/install-mojo.html" class="externalLink">maven-install-plugin:install</a>
to install the built and tested artifacts to the local maven repository.</p></li>
</ol>
<p>The EventFlow fragment application code, test cases and sbunit are deployed to the test node :</p>
<p><img src="uml/one-node-sbunit.svg" alt="One node sbunit test" /></p>
<p>An example run is shown below :</p>

<pre class="prettyprint linenums"><code class="language-shell">$ mvn install
[INFO] Scanning for projects...
[INFO]
[INFO] -----------------------&lt; com.example:helloworld &gt;-----------------------
[INFO] Building Java Fragment - hello world 3.0.0
[INFO] -----------------------[ ep-eventflow-fragment ]------------------------
[INFO]
[INFO] --- ep-maven-plugin:2.1.0-SNAPSHOT:install-product (default-install-product-1) @ helloworld ---
[INFO] com.tibco.ep.sb.rt:platform_osxx86_64:zip:11.0.0-SNAPSHOT:test already installed manually to /Users/flionell/tibco/dev/core
[INFO]
[INFO] --- ep-maven-plugin:2.1.0-SNAPSHOT:set-resources (default-set-resources) @ helloworld ---
[INFO]
[INFO] --- maven-enforcer-plugin:3.0.0:enforce (hard-build-requirements) @ helloworld ---
[INFO]
[INFO] --- maven-resources-plugin:3.1.0:resources (default-resources) @ helloworld ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 0 resource
[INFO] Copying 0 resource
[INFO] Copying 2 resources
[INFO]
[INFO] --- ep-maven-plugin:2.1.0-SNAPSHOT:unpack-nar (default-unpack-nar) @ helloworld ---
[INFO]
[INFO] --- ep-maven-plugin:2.1.0-SNAPSHOT:unpack-fragment (default-unpack-fragment) @ helloworld ---
[INFO]
[INFO] --- maven-compiler-plugin:3.8.1:compile (default-compile-1) @ helloworld ---
[INFO] Nothing to compile - all classes are up to date
[INFO]
[INFO] --- ep-maven-plugin:2.1.0-SNAPSHOT:generate-main-eventflow (default-generate-main-eventflow) @ helloworld ---
[INFO] Found 1 module
[INFO]
[INFO] --- ep-maven-plugin:2.1.0-SNAPSHOT:compile-eventflow-fragment (default-compile-eventflow-fragment) @ helloworld ---
[INFO]
[INFO] --- maven-compiler-plugin:3.8.1:compile (default-compile) @ helloworld ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 1 source file to /Users/flionell/Documents/StreamBase Studio 11.0 Workspace/helloworld/target/classes
[INFO]
[INFO] --- maven-resources-plugin:3.1.0:testResources (default-testResources) @ helloworld ---
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] Copying 0 resource
[INFO] Copying 0 resource
[INFO]
[INFO] --- maven-compiler-plugin:3.8.1:testCompile (default-testCompile) @ helloworld ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 1 source file to /Users/flionell/Documents/StreamBase Studio 11.0 Workspace/helloworld/target/test-classes
[INFO]
[INFO] --- ep-maven-plugin:2.1.0-SNAPSHOT:generate-test-eventflow (default-generate-test-eventflow) @ helloworld ---
[INFO] Found 0 module
[INFO]
[INFO] --- maven-compiler-plugin:3.8.1:testCompile (default-testCompile-1) @ helloworld ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 1 source file to /Users/flionell/Documents/StreamBase Studio 11.0 Workspace/helloworld/target/test-classes
[INFO]
[INFO] --- ep-maven-plugin:2.1.0-SNAPSHOT:check-testcases (default-check-testcases) @ helloworld ---
[INFO]
[INFO] --- ep-maven-plugin:2.1.0-SNAPSHOT:start-nodes (default-start-nodes) @ helloworld ---
[INFO] UDP port 59781 selected for discovery
[INFO] [A.helloworld] Running &quot;install node&quot;
[INFO] [A.helloworld] 	Installing node
[INFO] [A.helloworld] 		DEVELOPMENT executables
[INFO] [A.helloworld] 		File shared memory
[INFO] [A.helloworld] 		7 concurrent allocation segments
[INFO] [A.helloworld] 		Host name MacBookPro-of-flionell.local
[INFO] [A.helloworld] 		Starting node services
[INFO] [A.helloworld] 		Loading node configuration
[INFO] [A.helloworld] 		Auditing node security
[INFO] [A.helloworld] 		Administration port is 9831
[INFO] [A.helloworld] 		Service name is A.helloworld
[INFO] [A.helloworld] 	Node installed
[INFO] [A.helloworld] Finished &quot;install node&quot;
[INFO] [helloworld] Running &quot;start node&quot;
[INFO] [A.helloworld] 	Starting node
[INFO] [A.helloworld] 		Loading node configuration
[INFO] [A.helloworld] 		Auditing node security
[INFO] [A.helloworld] 		Host name MacBookPro-of-flionell.local
[INFO] [A.helloworld] 		Administration port is 9831
[INFO] [A.helloworld] 		Service name is A.helloworld
[INFO] [A.helloworld] 	Node started
[INFO] [helloworld] Finished &quot;start node&quot;
[INFO]
[INFO] --- ep-maven-plugin:2.1.0-SNAPSHOT:test-eventflow-fragment (default-test-eventflow-fragment) @ helloworld ---
[INFO] [dtm] INFO: Deploy tool version: [TIBCO Distributed Transactional Memory Platform 11.0.0-SNAPSHOT (build 2202210815)] starting at [Mon Feb 28 11:12:20 CET 2022]
[INFO] [dtm] INFO: Node version: [TIBCO Streaming Runtime 11.0.0-SNAPSHOT (build 2202210837)]
[INFO] [dtm] INFO: Starting com.tibco.ep.buildmavenplugin.surefire.Runner on node A.helloworld ...
[INFO] [dtm] INFO: com.tibco.ep.buildmavenplugin.surefire.Runner started on JVM com_tibco_ep_buildmavenplugin_surefire_Runner0 on node A.helloworld.
[INFO] [A.helloworld] No user-defined Logback configuration, using product default configuration
[INFO] [A.helloworld] 2022-02-28 11:12:23.986000+0100 [516:main] INFO  com.tibco.ep.dtm.stdout:
[INFO] [A.helloworld] -------------------------------------------------------
[INFO] [A.helloworld]  T E S T S
[INFO] [A.helloworld] -------------------------------------------------------
[INFO] [A.helloworld] Running com.example.helloworld.TestCase
[INFO] [A.helloworld] Test Case 1
[INFO] [A.helloworld] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 3.853 sec
[INFO] [A.helloworld] 2022-02-28 11:12:27.850000+0100 [516:main] INFO  com.tibco.ep.dtm.stdout:
[INFO] [A.helloworld] Results :
[INFO] [A.helloworld] 2022-02-28 11:12:27.851000+0100 [516:main] INFO  com.tibco.ep.dtm.stdout:
[INFO] [A.helloworld] Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
[INFO] [A.helloworld] 2022-02-28 11:12:27.851000+0100 [516:main] INFO  com.tibco.ep.dtm.stdout:
[INFO] [dtm] INFO: Engine com_tibco_ep_buildmavenplugin_surefire_Runner0 on node [A.helloworld] exited with status [0]
[INFO] [helloworld] Finished &quot;deploy com.tibco.ep.buildmavenplugin.surefire.Runner&quot;
[INFO]
[INFO] --- ep-maven-plugin:2.1.0-SNAPSHOT:stop-nodes (default-stop-nodes-1) @ helloworld ---
[INFO] [A.helloworld] Running &quot;stop node&quot;
[INFO] [A.helloworld] 	Stopping node
[INFO] [A.helloworld] 		Engine application::com_tibco_ep_buildmavenplugin_surefire_Runner0 stopped
[INFO] [A.helloworld] 	Node stopped
[INFO] [A.helloworld] Finished &quot;stop node&quot;
[INFO] [A.helloworld] Running &quot;remove node&quot;
[INFO] [A.helloworld] 	Removing node
[INFO] [A.helloworld] 		Shutting down node services
[INFO] [A.helloworld] 		Engine System::administration stopped
[INFO] [A.helloworld] 	Node removed
[INFO] [A.helloworld] Finished &quot;remove node&quot;
[INFO]
[INFO] --- ep-maven-plugin:2.1.0-SNAPSHOT:package-eventflow-fragment (default-package-eventflow-fragment) @ helloworld ---
[INFO] Building zip: /Users/flionell/Documents/StreamBase Studio 11.0 Workspace/helloworld/target/helloworld-3.0.0-ep-eventflow-fragment.zip
[INFO]
[INFO] &gt;&gt;&gt; maven-source-plugin:3.2.1:jar (attach-sources) &gt; generate-sources @ helloworld &gt;&gt;&gt;
[INFO]
[INFO] --- ep-maven-plugin:2.1.0-SNAPSHOT:install-product (default-install-product-1) @ helloworld ---
[INFO] com.tibco.ep.sb.rt:platform_osxx86_64:zip:11.0.0-SNAPSHOT:test already installed manually to /Users/flionell/tibco/dev/core
[INFO]
[INFO] --- ep-maven-plugin:2.1.0-SNAPSHOT:set-resources (default-set-resources) @ helloworld ---
[INFO]
[INFO] --- maven-enforcer-plugin:3.0.0:enforce (hard-build-requirements) @ helloworld ---
[INFO]
[INFO] &lt;&lt;&lt; maven-source-plugin:3.2.1:jar (attach-sources) &lt; generate-sources @ helloworld &lt;&lt;&lt;
[INFO]
[INFO]
[INFO] --- maven-source-plugin:3.2.1:jar (attach-sources) @ helloworld ---
[INFO] Building jar: /Users/flionell/Documents/StreamBase Studio 11.0 Workspace/helloworld/target/helloworld-3.0.0-sources.jar
[INFO]
[INFO] --- maven-javadoc-plugin:3.3.1:jar (attach-javadocs) @ helloworld ---
[INFO]
[INFO] --- maven-install-plugin:2.5.2:install (default-install) @ helloworld ---
[INFO] Installing /Users/flionell/Documents/StreamBase Studio 11.0 Workspace/helloworld/target/helloworld-3.0.0-ep-eventflow-fragment.zip to /Users/flionell/tibco/dev/core/BUILD/repository/com/example/helloworld/3.0.0/helloworld-3.0.0.zip
[INFO] Installing /Users/flionell/Documents/StreamBase Studio 11.0 Workspace/helloworld/pom.xml to /Users/flionell/tibco/dev/core/BUILD/repository/com/example/helloworld/3.0.0/helloworld-3.0.0.pom
[INFO] Installing /Users/flionell/Documents/StreamBase Studio 11.0 Workspace/helloworld/target/helloworld-3.0.0-sources.jar to /Users/flionell/tibco/dev/core/BUILD/repository/com/example/helloworld/3.0.0/helloworld-3.0.0-sources.jar
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  37.467 s
[INFO] Finished at: 2022-02-28T11:12:34+01:00
[INFO] ------------------------------------------------------------------------
</code></pre></section><section><a id="Calling_out_to_java"></a>
<h2>Calling out to java</h2>
<p>Java code that needs to be included with the application can be placed in
java source directory ( src/main/java ).  This code will be added to the
fragment and included with any test cases.</p></section><section><a id="External_dependency"></a>
<h2>External dependency</h2>
<p>External java (jar) dependencies can be added to the maven pom.xml - these are
then included in build, test and package steps.</p>
<p>For example :</p>

<pre class="prettyprint linenums"><code class="language-xml">...
    &lt;dependencies&gt;

        &lt;!-- compile, test and deploy dependencies --&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.jpos&lt;/groupId&gt;
            &lt;artifactId&gt;jpos&lt;/artifactId&gt;
            &lt;version&gt;1.6.8&lt;/version&gt;
        &lt;/dependency&gt;

        ...

    &lt;/dependencies&gt;
...
</code></pre></section><section><a id="Building_native_libraries"></a>
<h2>Building native libraries</h2>
<p>Whilst a maven build could use <a href="http://www.mojohaus.org/exec-maven-plugin/" class="externalLink">exec-maven-plugin</a>
to call the native toolchain ( make, g++ etc ), the maven plugin
<a href="http://maven-nar.github.io/" class="externalLink">nar-maven-plugin</a> is recommended - this plugin
performs the native build and creates a nar archive.  The nar archive can be
treated like any other maven dependency.</p>
<p>An example of creating a nar archive is shown below :</p>

<pre class="prettyprint linenums"><code class="language-xml">&lt;project&gt;

    &lt;groupId&gt;com.tibco.ep.dtmexamples.eventflowfragment&lt;/groupId&gt;
    &lt;artifactId&gt;cpp-lib&lt;/artifactId&gt;
    &lt;packaging&gt;nar&lt;/packaging&gt;
    &lt;version&gt;3.0.0&lt;/version&gt;
    
    ....
   
    &lt;build&gt;

        &lt;plugins&gt;

            &lt;plugin&gt;
                &lt;groupId&gt;com.github.maven-nar&lt;/groupId&gt;
                &lt;artifactId&gt;nar-maven-plugin&lt;/artifactId&gt;
                &lt;version&gt;3.2.0&lt;/version&gt;
                &lt;extensions&gt;true&lt;/extensions&gt;
                &lt;configuration&gt;
                    &lt;libraries&gt;
                        &lt;library&gt;
                            &lt;type&gt;jni&lt;/type&gt;
                            &lt;narSystemPackage&gt;com.tibco.ep.dtmexamples.eventflowfragment.sbappcallscpp&lt;/narSystemPackage&gt;
                        &lt;/library&gt;
                    &lt;/libraries&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;

        &lt;/plugins&gt;

    &lt;/build&gt;

&lt;/project&gt;
</code></pre>
<p>A EventFlow fragment can then use this nar archive :</p>

<pre class="prettyprint linenums"><code class="language-xml">...
    &lt;!-- common definitions for this version of StreamBase --&gt;
    &lt;parent&gt;
        &lt;groupId&gt;com.tibco.ep.sb.parent&lt;/groupId&gt;
        &lt;artifactId&gt;ep-eventflow-fragment&lt;/artifactId&gt;
        &lt;version&gt;10.4.0&lt;/version&gt;
    &lt;/parent&gt;
...
    &lt;dependencies&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;com.tibco.ep.dtmexamples.eventflowfragment&lt;/groupId&gt;
            &lt;artifactId&gt;cpp-lib&lt;/artifactId&gt;
            &lt;version&gt;3.0.0&lt;/version&gt;
            &lt;type&gt;nar&lt;/type&gt;
            &lt;classifier&gt;amd64-Linux-gpp-jni&lt;/classifier&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.tibco.ep.dtmexamples.eventflowfragment&lt;/groupId&gt;
            &lt;artifactId&gt;cpp-lib&lt;/artifactId&gt;
            &lt;version&gt;3.0.0&lt;/version&gt;
            &lt;type&gt;nar&lt;/type&gt;
            &lt;classifier&gt;x86_64-MacOSX-gpp-jni&lt;/classifier&gt;
        &lt;/dependency&gt;
        
        ....
        
    &lt;/dependencies&gt;
...
</code></pre>
<p>Note that if the nar module is built on different platforms, the EventFlow
fragment module will add all architectures to the fragment zip.</p>
<p>See <a href="http://maven-nar.github.io/aol.html" class="externalLink">aol</a> for the list of
Architecture-OperatingSystem-Linker (AOL) values references in the classifer
above.  The maven plugin will map these to the internal paths when the
fragment is built.</p></section><section><a id="Third_party_native_libraries"></a>
<h2>Third party native libraries</h2>
<p>Its also possible to build a nar archive containing shared libraries from
a third party - ie when the source isn't available.  The directory
structure for such a nar project is :</p>
<p><img src="uml/thirdparty-nar-structure.svg" alt="Nar directory structure" /></p>
<p>The pom.xml for this project will use the nar-maven-plugin and specify
shared libraries :</p>

<pre class="prettyprint linenums"><code class="language-xml">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;groupId&gt;com.example&lt;/groupId&gt;
    &lt;artifactId&gt;thirdpartylibs&lt;/artifactId&gt;
    &lt;packaging&gt;nar&lt;/packaging&gt;
    &lt;name&gt;ThirdParty Shared Libraries&lt;/name&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;

    &lt;parent&gt;
        &lt;groupId&gt;com.tibco.ep.sb.parent&lt;/groupId&gt;
        &lt;artifactId&gt;common&lt;/artifactId&gt;
        &lt;version&gt;10.4.0&lt;/version&gt;
        &lt;relativePath/&gt;
    &lt;/parent&gt;  

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;com.github.maven-nar&lt;/groupId&gt;
                &lt;artifactId&gt;nar-maven-plugin&lt;/artifactId&gt;
                &lt;extensions&gt;true&lt;/extensions&gt;
                &lt;configuration&gt;
                    &lt;libraries&gt;
                        &lt;library&gt;
                            &lt;type&gt;shared&lt;/type&gt;
                        &lt;/library&gt;
                    &lt;/libraries&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

&lt;/project&gt;
</code></pre>
<p>The built artifact can then be added to a project as a normal maven dependency
and the shared libraries will be included in the runtime library path.</p>

<pre class="prettyprint linenums"><code class="language-xml">    &lt;!-- Bring in right shared library for this platform --&gt;
    &lt;profiles&gt;
        &lt;profile&gt;
            &lt;id&gt;linux profile&lt;/id&gt;
            &lt;activation&gt;
                &lt;os&gt;&lt;name&gt;linux&lt;/name&gt;&lt;/os&gt;
            &lt;/activation&gt;
            &lt;dependencies&gt;
                &lt;dependency&gt;
                    &lt;groupId&gt;com.example&lt;/groupId&gt;
                    &lt;artifactId&gt;thirdpartylibs&lt;/artifactId&gt;
                    &lt;version&gt;1.0.0&lt;/version&gt;
                    &lt;type&gt;nar&lt;/type&gt;
                    &lt;classifier&gt;amd64-Linux-gpp-shared&lt;/classifier&gt;
                &lt;/dependency&gt;
            &lt;/dependencies&gt;
        &lt;/profile&gt;
        &lt;profile&gt;
            &lt;id&gt;mac profile&lt;/id&gt;
            &lt;activation&gt;
                &lt;os&gt;&lt;name&gt;mac os x&lt;/name&gt;&lt;/os&gt;
            &lt;/activation&gt;
            &lt;dependencies&gt;
                &lt;dependency&gt;
                    &lt;groupId&gt;com.example&lt;/groupId&gt;
                    &lt;artifactId&gt;thirdpartylibs&lt;/artifactId&gt;
                    &lt;version&gt;1.0.0&lt;/version&gt;
                    &lt;type&gt;nar&lt;/type&gt;
                    &lt;classifier&gt;x86_64-MacOSX-gpp-shared&lt;/classifier&gt;
                &lt;/dependency&gt;
            &lt;/dependencies&gt;
        &lt;/profile&gt;
        &lt;profile&gt;
            &lt;id&gt;windows profile&lt;/id&gt;
            &lt;activation&gt;
                &lt;property&gt;
                    &lt;name&gt;path.separator&lt;/name&gt;
                    &lt;value&gt;;&lt;/value&gt;
                &lt;/property&gt;
            &lt;/activation&gt;
            &lt;dependencies&gt;
                &lt;dependency&gt;
                    &lt;groupId&gt;com.example&lt;/groupId&gt;
                    &lt;artifactId&gt;thirdpartylibs&lt;/artifactId&gt;
                    &lt;version&gt;1.0.0&lt;/version&gt;
                    &lt;type&gt;nar&lt;/type&gt;
                    &lt;classifier&gt;amd64-Windows-msvc-shared&lt;/classifier&gt;
                &lt;/dependency&gt;
            &lt;/dependencies&gt;
        &lt;/profile&gt;
    &lt;/profiles&gt;
</code></pre></section><section><a id="Multiple_sbapps"></a>
<h2>Multiple sbapps</h2>
<p>There is no difference between a fragment consisting of one sbapp file
and a fragment consisting of multiple sbapp files.  Multiple sbapp and
sbint files are added to the EventFlow fragment.</p></section><section><a id="Java_adapters"></a>
<h2>Java adapters</h2>
<p>EventFlow adapters written in java can be built in a maven module with a
packaging type of jar and use a EventFlow application with sbunit to test.</p>
<p>An example pom.xml file for an adapter is shown below :</p>

<pre class="prettyprint linenums"><code class="language-xml">...
    &lt;groupId&gt;com.tibco.ep.dtmexamples.eventflowfragment&lt;/groupId&gt;
    &lt;artifactId&gt;adapter&lt;/artifactId&gt;
    &lt;packaging&gt;jar&lt;/packaging&gt;
    &lt;version&gt;3.0.0&lt;/version&gt;
...
    &lt;!-- common definitions for this version of StreamBase --&gt;
    &lt;parent&gt;
        &lt;groupId&gt;com.tibco.ep.sb.parent&lt;/groupId&gt;
        &lt;artifactId&gt;ep-java-fragment&lt;/artifactId&gt;
        &lt;version&gt;10.4.0&lt;/version&gt;
    &lt;/parent&gt;
...
</code></pre>
<p>To use this adapter in a EventFlow application just set as a dependency :</p>

<pre><code class="nohighlight nocode">    &lt;dependencies&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;com.tibco.ep.dtmexamples.eventflowfragment&lt;/groupId&gt;
            &lt;artifactId&gt;adapter&lt;/artifactId&gt;
            &lt;version&gt;3.0.0&lt;/version&gt;
        &lt;/dependency&gt;

        ....
</code></pre></section><section><a id="EventFlow_fragment_referencing_another_EventFlow_fragment"></a>
<h2>EventFlow fragment referencing another EventFlow fragment</h2>
<p>To import a EventFlow application add the fragment to the pom.xml
dependencies :-</p>

<pre class="prettyprint linenums"><code class="language-xml">    &lt;dependencies&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;com.tibco.ep.dtmexamples.eventflowfragment&lt;/groupId&gt;
            &lt;artifactId&gt;sbapp-calls-adapter&lt;/artifactId&gt;
            &lt;version&gt;3.0.0&lt;/version&gt;
            &lt;type&gt;ep-eventflow-fragment&lt;/type&gt;
        &lt;/dependency&gt;

        ....
</code></pre>
<p>The dependency is a binary dependency: the typecheck/build process reads information about the
dependency from the EventFlow archive. This archive is read from the maven repository during the
maven build, in the same way java dependencies are read. Building the current EventFlow does not
require the sources of the dependency.</p>
<p>This is also true in Studio: the EventFlow dependency project does not have to be opened in the
current workspace for the Studio build/typecheck to work. In this case, the information are also
read from the maven repository.
If a dependency is opened in the current workspace, then the information are read from the files
in the workspace, not from the repository.</p></section></section>        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Â©      2018â€“2025
<a href="https://www.cloud.com">Cloud Software Group, Inc.</a>
</p>
        </div>
      </div>
    </footer>
  </body>
</html>
